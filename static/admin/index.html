<!doctype html>
<html>
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Content Manager</title>
</head>
<body>
    <script src="https://identity.netlify.com/v1/netlify-identity-widget.js"></script>
    <script src="https://unpkg.com/netlify-cms@^2.9.6/dist/netlify-cms.js"></script>
    <script>
        CMS.registerEditorComponent({
          id:"youtube",
          label: "YouTube",
          fields:[{
             name: "link",
             label: "link",
             widget: "string",
             default: "https://www.youtube.com/watch?v=QILiHiTD3uc"
          }],
          pattern: /{{< youtube "(.*)" >}}/,
          fromBlock: function(match){
             return{
                link: match[1]
             };
          },
          toBlock: ({link}) =>
             `{{< youtube "${link}" >}}`,
       
          toPreview: ({link}) => {
           return `
           <style>.embed-container { position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden; max-width: 100%; } .embed-container iframe, .embed-container object, .embed-container embed { position: absolute; top: 0; left: 0; width: 100%; height: 100%; }</style><div class='embed-container'><iframe src='https://www.youtube.com/embed/${new URL(link).searchParams.get("v")}' frameborder='0' allowfullscreen></iframe></div>
            `
          }
        })
       </script>
</body>
</html>
